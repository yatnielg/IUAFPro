{% extends "account/base.html" %}
{% load i18n %}

{% block title %}Nueva contraseña — IUAFPro{% endblock %}

{% block account_content %}
<div class="container" style="max-width: 520px;">
  <div class="card shadow-sm border-0">
    <div class="card-body p-4">
      {% if token_fail %}
        <h1 class="h5 mb-2">{% trans "Enlace inválido o expirado" %}</h1>
        <p class="text-secondary small mb-4">
          {% blocktrans %}Solicita un nuevo enlace para restablecer tu contraseña.{% endblocktrans %}
        </p>
        <a class="btn btn-primary" href="{% url 'account_reset_password' %}">
          {% trans "Pedir nuevo enlace" %}
        </a>
      {% else %}
        <h1 class="h5 mb-3">{% trans "Define tu nueva contraseña" %}</h1>

        {% if form.non_field_errors %}
          <div class="alert alert-danger">{{ form.non_field_errors }}</div>
        {% endif %}

        <form method="post" action="{{ action_url }}">
          {% csrf_token %}
          <div class="mb-3">
            <label class="form-label" for="id_password1">{% trans "Nueva contraseña" %}</label>
            {{ form.password1 }}
          </div>
          <div class="mb-3">
            <label class="form-label" for="id_password2">{% trans "Confirmar nueva contraseña" %}</label>
            {{ form.password2 }}
          </div>
          <button class="btn btn-primary w-100" type="submit">{% trans "Guardar contraseña" %}</button>
        </form>

        <script>
          document.querySelectorAll("input[type='password']").forEach(el=>el.classList.add("form-control"));
        </script>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
