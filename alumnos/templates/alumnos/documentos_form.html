{% extends "panel/grafico.html" %}
{% load i18n %}

{% block title %}Documentos — Alumno {{ alumno.numero_estudiante }}{% endblock %}

{% block main_content %}

<style>
  /* Asegura que el botón “Examinar” sea visible con Material Dashboard/Bootstrap */
  input[type="file"]{
    display:inline-block;
    width:100%;
    margin-top:.25rem;
    opacity:1 !important;
    position:static !important;
    height:auto;
  }
  .fileinput input[type="file"],
  .custom-file input[type="file"]{
    position:static !important;
  }
  .small-muted{ color:#9aa0a6; font-size:.875rem; }
</style>

<div class="d-flex justify-content-between align-items-center mb-3">
  <h1 class="h5 m-0">
    <i class="material-icons align-middle mr-1">description</i>
    Documentos del alumno {{ alumno.numero_estudiante }}
  </h1>
  <div class="btn-group">
    <a class="btn btn-outline-secondary" href="{% url 'alumnos_detalle' alumno.pk %}">
      <i class="material-icons align-middle">arrow_back</i> Volver
    </a>
  </div>
</div>

<div class="card">
  <div class="card-header card-header-primary card-header-icon">
    <div class="card-icon"><i class="material-icons">folder</i></div>
    <h4 class="card-title">Subir / actualizar documentos</h4>
    <p class="card-category">Formatos aceptados preconfigurados en el formulario</p>
  </div>

  <div class="card-body">
    {% if messages %}
      {% for m in messages %}
        <div class="alert alert-{{ m.tags }}">{{ m }}</div>
      {% endfor %}
    {% endif %}

    {% if form.non_field_errors %}
      <div class="alert alert-danger">
        {% for e in form.non_field_errors %}<div>{{ e }}</div>{% endfor %}
      </div>
    {% endif %}

    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}

      <div class="row">
        <!-- Columna izquierda -->
        <div class="col-md-6">
          <div class="form-group">
            <label>{{ form.acta_nacimiento.label }}</label>
            {{ form.acta_nacimiento }}
            {% for e in form.acta_nacimiento.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
            {% if alumno.documentos.acta_nacimiento %}
              <small class="form-text text-muted">Actual:
                <a href="{{ alumno.documentos.acta_nacimiento.url }}" target="_blank">Ver archivo</a>
              </small>
            {% endif %}
          </div>

          <div class="form-group">
            <label>{{ form.certificado_estudios.label }}</label>
            {{ form.certificado_estudios }}
            {% for e in form.certificado_estudios.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
            {% if alumno.documentos.certificado_estudios %}
              <small class="form-text text-muted">Actual:
                <a href="{{ alumno.documentos.certificado_estudios.url }}" target="_blank">Ver archivo</a>
              </small>
            {% endif %}
          </div>

          <div class="form-group">
            <label>{{ form.solicitud_registro.label }}</label>
            {{ form.solicitud_registro }}
            {% for e in form.solicitud_registro.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
            {% if alumno.documentos.solicitud_registro %}
              <small class="form-text text-muted">Actual:
                <a href="{{ alumno.documentos.solicitud_registro.url }}" target="_blank">Ver archivo</a>
              </small>
            {% endif %}
          </div>

          <div class="form-group">
            <label>{{ form.carta_compromiso.label }}</label>
            {{ form.carta_compromiso }}
            {% for e in form.carta_compromiso.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
            {% if alumno.documentos.carta_compromiso %}
              <small class="form-text text-muted">Actual:
                <a href="{{ alumno.documentos.carta_compromiso.url }}" target="_blank">Ver archivo</a>
              </small>
            {% endif %}
          </div>

          <div class="form-group">
            <label>{{ form.identificacion_oficial.label }}</label>
            {{ form.identificacion_oficial }}
            {% for e in form.identificacion_oficial.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
            {% if alumno.documentos.identificacion_oficial %}
              <small class="form-text text-muted">Actual:
                <a href="{{ alumno.documentos.identificacion_oficial.url }}" target="_blank">Ver archivo</a>
              </small>
            {% endif %}
          </div>
        </div>

        <!-- Columna derecha -->
        <div class="col-md-6">
          <div class="form-group">
            <label>{{ form.curp.label }}</label>
            {{ form.curp }}
            {% for e in form.curp.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
            {% if alumno.documentos.curp %}
              <small class="form-text text-muted">Actual:
                <a href="{{ alumno.documentos.curp.url }}" target="_blank">Ver archivo</a>
              </small>
            {% endif %}
          </div>

          <div class="form-group">
            <label>{{ form.titulo_grado.label }}</label>
            {{ form.titulo_grado }}
            {% for e in form.titulo_grado.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
            {% if alumno.documentos.titulo_grado %}
              <small class="form-text text-muted">Actual:
                <a href="{{ alumno.documentos.titulo_grado.url }}" target="_blank">Ver archivo</a>
              </small>
            {% endif %}
          </div>

          <div class="form-group">
            <label>{{ form.validacion_autenticidad.label }}</label>
            {{ form.validacion_autenticidad }}
            {% for e in form.validacion_autenticidad.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
            {% if alumno.documentos.validacion_autenticidad %}
              <small class="form-text text-muted">Actual:
                <a href="{{ alumno.documentos.validacion_autenticidad.url }}" target="_blank">Ver archivo</a>
              </small>
            {% endif %}
          </div>

          <div class="form-group">
            <label>{{ form.carta_interes.label }}</label>
            {{ form.carta_interes }}
            {% for e in form.carta_interes.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
            {% if alumno.documentos.carta_interes %}
              <small class="form-text text-muted">Actual:
                <a href="{{ alumno.documentos.carta_interes.url }}" target="_blank">Ver archivo</a>
              </small>
            {% endif %}
          </div>

          <div class="form-group">
            <label>{{ form.otro_documento.label }}</label>
            {{ form.otro_documento }}
            {% for e in form.otro_documento.errors %}<div class="text-danger small">{{ e }}</div>{% endfor %}
            {% if alumno.documentos.otro_documento %}
              <small class="form-text text-muted">Actual:
                <a href="{{ alumno.documentos.otro_documento.url }}" target="_blank">Ver archivo</a>
              </small>
            {% endif %}
          </div>
        </div>
      </div>

      <div class="text-right">
        <button type="submit" class="btn btn-primary">
          <i class="material-icons align-middle">save</i> Guardar
        </button>
      </div>
    </form>
  </div>
</div>
{% endblock %}
